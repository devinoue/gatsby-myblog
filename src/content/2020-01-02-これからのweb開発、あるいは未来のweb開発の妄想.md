---
title: これからのWeb開発、あるいは未来のWeb開発の妄想
tags:
  - Etc
image: /img/over.jpg
layout: post
author: Masaharu Inoue
date: 2020-01-02T05:19:44.131Z
draft: false
---
# バックエンドとフロントエンドの分離
現在LaravelはBladeと呼ばれるテンプレートエンジンを使用してWebのフロント側をマークアップしている。PHPという言語がそもそもがWebサイト指向というのもあるのだが、フロントをリアクティブにするためにJavaScriptでVueのコードを書きながらLaravelも書くという非常に歪つな状況にある。これはRuby on Railsも同様の問題を抱えているだろう。

フロントとバックエンドを分離したWeb開発は、今後ますます進む。

個人的にはその方向性は２方向に進むと思われる

## Vue ReactなどのフロントとバックエンドのAPI通信によるBFF
これは現在でも広く行われているが、フロントとバックエンドを切り離し、データの送受信をAPIを用いて行う方法である。旧来のやり方を踏襲しつつも、同時にBFFを実現しており難易度はそこそこ低い。
しいて問題といえば、それまで一気通貫できた認証やページネーションの実装をそれぞれで行う必要があり、そのやり方はプロジェクトによってまちまちで技術が洗練されていない。
この認証というのが非常に厄介で、いやある程度マニュアル化はされてはいるのだが、それでもフロント側に認証ロジックを仕込むのは面倒で、それがファイルアップローダーだったりソーシャル認証だったりすると更に面倒になる。

## PaaSとフロントエンドのコラボレーション
バックエンドをほぼ全て特定のXaaS上で実行する。具体的にはLambdaのようなFassSや、CognitoのようなIDaaSにそれぞれの機能を担ってもらう。
PaaSの提供するバックエンド機能を最大限にフル活用すれば、従来のWebアプリケーションアレームワークに相当する機能を継ぎ接ぎできるだろう。
一方その弱点は、それぞれのサービスがまとまりが薄く、またベンダーを越えたサービスの共有は難しいというのが現実で、AWSやFirebaseといった特定のサービスに縛られることでWebフレームワークよりも自由に機能を実装することが難しい。
FaaSはペイロード容量にも限界があり(たとえばLambdaは6MB)、ファイルアップローダーをFaaSで実装するには一工夫いる(S3にアップさせる)。当然認証関係もクリアにする必要があり、これは開発者の力量もあるのだが、僕にとってはかなり面倒な部分だ。サーバーレスなのだから当然だが、Laravelはそれに比べて一貫してでできてしまうので、ついつい「ああ、これがLaravelだったらなぁ」などと思えてしまう。
詰まるところPaaSは便利ではあるが不自由さがあり、それがDXを低くする理由になっている。

# JavaScript/TypeScriptによるWeb支配
これは妄想に近いのだが、現在の所フロントエンドはJavaScriptがないと成立しない状況にある。JavaScript、そしてその進化系といえるTypeScriptは最早動かしがたいWebの北極星なのだ。我々Web開発者は、どう足掻こうと結局はJavaScriptに行き着くことになる。RoRエンジニアでも、WPエンジニアでも、Djangoエンジニアでも、誰もがJavaScriptを大なり小なり知っているのだ。
一方でバックエンドには言語それぞれがありPHPやRubyが主流で、Nodejs、Python、Go、C#などが存在する。
そういう状況を考えると、今後一気通貫となる開発を考えると、バックエンドもJavaScriptで完成できれば、それに越したことはないと僕は思っている。
Expressはその候補だったが、Laravelなどと比べると見劣りしてしまう。LaravelはArtisanを通じてDBのテーブル作成からスキーマ作成まであらゆることをカバーしてくれる多機能Webフレームワークで、一つのフレームワークで包括的なエコシステムを完成させてくれる。まさにそのような存在がJavaScriptにも必要だと常々思っている。

特にBFFの面倒な所は「APIを意識しながら」のWeb開発だ。例えばORMがあればデータベースを意識せず、オブジェクト指向プログラミングの感覚でデータベースを触ることができる。これはデータベースについて考えなくていいという意味ではないのだが、「ほとんど」考えずに開発ができる。

しかしAPIについてはどうだろうか？現在のマイクロサービスアーキテクチャの流れにおいて、APIは必須の技術なのだが、われわれ開発者はいちいちAPIのエンドポイントへ接続する意識が強く持ちながら開発をしていて、いちいちasync/awaitを書きながら日々の非同期通信を実現している。このasync/awaitは慣れてしまえばどうということもないのだが、冷静に考えてみると違和を覚えてならない。なんで毎回同じことを書かないといけないのだろうか？　APIであることが分かっていて、非同期通信が必要だと分かっているのに、async/awaitを儀式のようにつけるというのはどういうことだ？

これはナンセンスな現状だ。いちいちリソースとメソッドを切り替えながら、「"users/"」といった文字列を使ってコーデイングをするのはエラーを生む危険性すらある。

もしも未来の大規模Webフレームワークがあるとすれば、それはDB、GraphQL、状態管理がそれぞれ共通のORMで手軽に使用できるようにデザインされているのではないかと想像する。
たしかに現在でも状態管理ORMというものは存在するのだが、まぁあまり流行ってはいない。


## 結局の所、それはモノリシックデザインへの回帰なのか？
結局の所、モノリシック設計は簡単なのだ。開発者は一つのフレームワークに長けていれば、ある程度のものが作れてしまう。工数も短くなると思う。
マイクロサービスは保守性や拡張性という点では優秀で、場合によっては見晴らしもよくなるのだが、場合によっては見晴らしが悪くなる。
マイクロサービスアーキテクチャは面倒でもあるのだ。とりわけそれぞれのAPIの管理が死ぬほど面倒くさい。これはどうにかしないと、DXはますます下がっていくだろう。
開発者はAPIを意識せずにマイクロサービスを利用できるようになれば、たとえばちょっとしたコマンドをターミナルで打つと新しいAPIが作られ、あるクラスファイルを読み込むとそのAPIをORMのような感覚で利用できる……
そういう未来は理想なのではないか。

## PHPのJavaScriptへの統合？
もう一つの妄想だが、PHPは今でも進化を続けている。他の言語のいいところを取り入れようとしているし、静的型付けを目指してPHP8からはP++という言語まで作ると発表している。
この発展性ある言語は、元来Web指向なのだから、JavaScriptとの連携を真剣に考えるべきではないのか？
今までなんとなくJavaScriptと共存してきた。しかしPHP<->JavaScriptの変数の受け渡しとなると途端に杜撰になる。
PHPのHTML部分にJavaScriptを書いて、そこにPHPの変数でJavaScriptに変数を与える、という極端な例もある。

率直にいってこの辺りのJavaScriptと連携ができるバックエンド系言語があれば、その地位は盤石となるだろう。


# 終わりに
JavaScriptによるWeb言語の統一は、バベルの塔を建てるようなものかもしれない。
そして長らく望まれているが、未だに見上げるほどの塔を建てたものはいない。
ただWebの進化は早いので、いずれはその中から見上げるそういうフレームワークが来るだろうと信じている。

